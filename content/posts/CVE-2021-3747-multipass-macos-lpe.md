---
title: "CVE-2021-3747 - Multipass.app 1.7.0 - Local Privilege Escalation"
date: 2021-11-
tags: ['cve', 'lpe', 'privesc', 'macos', 'vulnerability']
categories: ['Research']
featuredImage: images/posts/vscode-global-state.png
draft: true
---

## Summary

I discovered a way to escalate privileges on macOS with 

https://ubuntu.com/security/CVE-2021-3747

- Background
    - Trying Multipass.app on macOS
    - Multipass is an app for running Ubuntu VMs on Linux, macOS and Windows
    - Similar experience to public cloud locally, can use cloud-init
    - Discovered some file ownership issues that provide a local attacker the ability to escalate privileges to root, reported to Canonical
- Process
    - Heard about the app, installed via Homebrew
    - Run the app and use it for a bit
    - Check running processes, binary paths, integrity level
    - Notice location of LaunchDaemon and supporting binaries
    - Make a hypothesis, test it
    - Uninstall and reinstall via Package Installer to confirm
    - Report via email to vendor
- Vulnerability
    - Application installs a persistent LaunchDaemon which runs as root, multipassd
    - It launches other processes as root
    - The application needs to do this in order to perform its tasks as a virtual machine manager
    - There is also an uninstall script that requires sudo to run
    - All of these are in a folder owned by the user that installed the application, but it should be owned by root
    - Therefore we can modify, replace or shim binaries and a script that run in a root context
    - 
- Experience working with Canonical/Ubuntu Security
    - Fast and courteous response
    - Clear communication
    - Quick resolution
